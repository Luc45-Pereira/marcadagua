#bibliotecas
import zipfile
import cv2
import numpy as np
import glob
import os

from numpy._distributor_init import filename


# logotipo
logo = cv2.imread("logo.jpg")
h_logo, w_logo, _ = logo.shape

# marcadagua
marcadagua = cv2.imread("marcadagua.jpg")
h_marcadagua, w_marcadagua, _ = marcadagua.shape


# imagens 
images_path = glob.glob("images/*.*")
print("adicionando marcadagua")

    
    #localização logo
for img_path in images_path:
    img = cv2.imread(img_path)
    h_img, w_img, _ = img.shape
    center_y = int(h_img / 1)
    center_x = int(w_img / 1)
    top_y = center_y - int(h_logo / 1)
    left_x = center_x - int(w_logo / 1)
    bottom_y = top_y + h_logo
    right_x = left_x + w_logo

    roi = img[top_y:bottom_y, left_x:right_x]

    result = cv2.addWeighted(roi, 0, logo, 1, 1)
    img[top_y:bottom_y, left_x:right_x] = result
    filename= os.path.basename(img_path)
    
    
#exportando imagens
    cv2.imwrite("images_marcadagua/" + filename, img)
    
#cria um arquivo .zip com todas as imagens
    zf = zipfile.ZipFile("images.zip", "w")
for dirname, subdirs, files in os.walk("images_marcadagua"):
    zf.write(dirname)
    for filename in files:
        zf.write(os.path.join(dirname, filename))
zf.close()


print("Sucesso ! :)")